let rec outer n acc =
  if n <= 0 then acc
  else
    let rec middle m acc2 =
      if m <= 0 then acc2
      else
        let rec inner k acc3 =
          if k <= 0 then acc3
          else inner (k - 1) (acc3 + k)
        in
        let acc2' = inner 1000 acc2 in
        middle (m - 1) acc2'
    in
    let acc' = middle 100 acc in
    outer (n - 1) acc'
in
outer 100 0
