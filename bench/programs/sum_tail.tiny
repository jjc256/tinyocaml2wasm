let rec outer n acc =
  if n <= 0 then acc
  else
    let rec middle m acc2 =
      if m <= 0 then acc2
      else
        let rec inner k acc3 =
          if k <= 0 then acc3
          else inner (k - 1) (acc3 + k)
        in
        let acc2_next = inner 100 acc2 in
        middle (m - 1) acc2_next
    in
    let acc_next = middle 10 acc in
    outer (n - 1) acc_next
in
outer 10 0
